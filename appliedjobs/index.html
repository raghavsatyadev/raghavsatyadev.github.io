<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Applied Jobs</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        .date-list {
            list-style-type: none;
            padding: 0;
        }

        .date-list li {
            margin: 5px 0;
        }

        .date-list a {
            text-decoration: none;
            color: blue;
        }

        .job-entry {
            margin-bottom: 20px;
        }

        .job-entry h3 {
            margin: 0;
        }

        .job-entry p {
            margin: 5px 0;
        }
    </style>
</head>
<body>
<h1>Applied Jobs</h1>
<ul id="dateList" class="date-list"></ul>
<div id="jobDetails"></div>
<script>
    // Directory containing the JSON files
    const jsonDirectory = '../appliedjobs/jsons/';

    async function listJsonFiles() {
        const apiUrl = 'https://api.github.com/repos/raghavsatyadev/raghavsatyadev.github.io/contents/appliedjobs/jsons';

        try {
            const response = await fetch(apiUrl);
            const data = await response.json();

            // Filter for JSON files and extract their names
            const jsonFiles = data
                .filter(item => item.type === 'file' && item.name.endsWith('.json'))
                .map(item => item.name);

            // Sort files in descending order based on date in filename
            jsonFiles.sort((a, b) => {
                const [dayA, monthA, yearA] = a.replace('.json', '').split('-').map(Number);
                const [dayB, monthB, yearB] = b.replace('.json', '').split('-').map(Number);
                const dateA = new Date(yearA, monthA - 1, dayA);
                const dateB = new Date(yearB, monthB - 1, dayB);
                return dateB - dateA;
            });

            const dateList = document.getElementById('dateList');
            jsonFiles.forEach(fileName => {
                const date = fileName.replace('.json', '');
                const listItem = document.createElement('li');
                const anchor = document.createElement('a');
                anchor.href = '#';
                anchor.textContent = date;
                anchor.addEventListener('click', () => loadJsonData(date));
                listItem.appendChild(anchor);
                dateList.appendChild(listItem);
            });
        } catch (error) {
            console.error('Error fetching JSON files:', error);
        }
    }


    // Function to load and display job data from a selected JSON file
    async function loadJsonData(date) {
        try {
            const response = await fetch(`${jsonDirectory}${date}.json`);
            const jobs = await response.json();
            const jobDetails = document.getElementById('jobDetails');
            jobDetails.innerHTML = ''; // Clear previous details

            jobs.forEach(job => {
                const jobEntry = document.createElement('div');
                jobEntry.className = 'job-entry';

                const titleLink = document.createElement('a');
                titleLink.href = job.externalUrl;
                titleLink.target = '_blank';
                const titleHeading = document.createElement('h3');
                titleHeading.textContent = job.companyName;
                titleLink.appendChild(titleHeading);
                jobEntry.appendChild(titleLink);

                const descriptionPara = document.createElement('p');
                descriptionPara.textContent = job.description;
                jobEntry.appendChild(descriptionPara);

                jobDetails.appendChild(jobEntry);
            });
        } catch (error) {
            console.error('Error loading JSON data:', error);
        }
    }

    // Initialize the page by listing available JSON files
    listJsonFiles();
</script>
</body>
</html>
